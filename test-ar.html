<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test AR Simple</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.5/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #debug {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            z-index: 9999;
            font-size: 12px;
            max-width: 300px;
        }
        #overlay-buttons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: none;
            flex-direction: column;
            gap: 10px;
            width: 90%;
            max-width: 400px;
        }
        .test-btn {
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            border: 4px solid white;
            border-radius: 15px;
            cursor: pointer;
            background: #FF6B9D;
            color: white;
        }
    </style>
</head>
<body>
    <div id="debug">
        <div>Status: Initialisation...</div>
        <div id="marker-status">Marqueur: Non d√©tect√©</div>
        <div id="ar-status">AR: En attente</div>
    </div>

    <div id="overlay-buttons">
        <button class="test-btn" onclick="testAnswer('A')">R√©ponse A</button>
        <button class="test-btn" onclick="testAnswer('B')">R√©ponse B</button>
        <button class="test-btn" onclick="testAnswer('C')">R√©ponse C</button>
    </div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        vr-mode-ui="enabled: false">
        
        <a-marker type="barcode" value="0" id="marker-0">
            <!-- Container AR avec animation -->
            <a-entity id="ar-content" position="0 0 0" visible="false">
                <!-- Fond -->
                <a-plane position="0 0.5 0" rotation="-90 0 0" width="2" height="1.5" color="#FFF9E6" opacity="0.98"></a-plane>
                
                <!-- Bordure -->
                <a-plane position="0 0.5 -0.01" rotation="-90 0 0" width="2.1" height="1.6" color="#FFD93D"></a-plane>
                
                <!-- Texte question -->
                <a-text value="ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 2 + 2 ÿü" align="center" position="0 0.8 0.02" rotation="-90 0 0" color="#4D96FF" width="2"></a-text>
                
                <!-- Ic√¥ne -->
                <a-text value="ü¶ä" align="center" position="0 1.1 0.02" rotation="-90 0 0" width="3"></a-text>
            </a-entity>
        </a-marker>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
    </a-scene>

    <script>
        const debug = document.getElementById('debug');
        const markerStatus = document.getElementById('marker-status');
        const arStatus = document.getElementById('ar-status');
        const overlayButtons = document.getElementById('overlay-buttons');

        function log(msg) {
            console.log(msg);
            debug.innerHTML = `<div>${msg}</div>` + debug.innerHTML;
        }

        function testAnswer(answer) {
            alert('R√©ponse s√©lectionn√©e: ' + answer);
        }

        // Attendre que la sc√®ne soit charg√©e
        const scene = document.querySelector('a-scene');
        scene.addEventListener('loaded', () => {
            log('‚úÖ Sc√®ne A-Frame charg√©e');
            arStatus.textContent = 'AR: Sc√®ne charg√©e';
        });

        // D√©tecter le marqueur
        const marker = document.getElementById('marker-0');
        marker.addEventListener('markerFound', () => {
            log('üéØ MARQUEUR D√âTECT√â !');
            markerStatus.textContent = 'Marqueur: ‚úÖ D√âTECT√â';
            
            // Afficher le contenu AR
            const arContent = document.getElementById('ar-content');
            arContent.setAttribute('visible', 'true');
            arContent.setAttribute('animation', 'property: scale; from: 0 0 0; to: 1 1 1; dur: 800; easing: easeOutElastic');
            
            // Afficher les boutons
            overlayButtons.style.display = 'flex';
            
            log('‚úÖ Contenu AR affich√©');
        });

        marker.addEventListener('markerLost', () => {
            log('‚ùå Marqueur perdu');
            markerStatus.textContent = 'Marqueur: ‚ùå Perdu';
            
            // Cacher le contenu AR
            const arContent = document.getElementById('ar-content');
            arContent.setAttribute('visible', 'false');
            
            // Cacher les boutons
            overlayButtons.style.display = 'none';
        });

        log('üöÄ Script de test charg√©');
    </script>
</body>
</html>
